# ════════════════════════════════════════════════════════════════════════════════════════════════════════════
# 🚀 KITTY CONFIGURATION - High-Performance GPU-Based Terminal
# ════════════════════════════════════════════════════════════════════════════════════════════════════════════
# Matching WezTerm configuration with Kitty's advanced features
# Optimized for speed, modern workflows, and seamless integration with Neovim, tmux, and Zsh
# ════════════════════════════════════════════════════════════════════════════════════════════════════════════

# ────────────────────────────────────────────────────────────────────────────────────────────────────────────
# 🖋️ FONT CONFIGURATION - JetBrains Mono with Nerd Font symbols
# ────────────────────────────────────────────────────────────────────────────────────────────────────────────

# IMPORTANT: Using regular JetBrains Mono for ligatures, Nerd Font for symbols only
# This is because some Nerd Font patches can break ligatures

# Primary font - Regular JetBrains Mono (NOT Nerd Font) for working ligatures
font_family      JetBrains Mono
bold_font        auto
italic_font      auto
bold_italic_font auto

# Font size matching WezTerm (18.0)
font_size 18.0

# Line height and spacing (matching WezTerm's 1.0 values)
adjust_line_height  100%
adjust_column_width 100%

# Enable ligatures - JetBrains Mono supports 142+ code ligatures
disable_ligatures never

# Font features for ligatures (simplified for regular JetBrains Mono)
font_features JetBrainsMono-Regular +liga +calt
font_features JetBrainsMono-Bold +liga +calt
font_features JetBrainsMono-Italic +liga +calt
font_features JetBrainsMono-BoldItalic +liga +calt

# Nerd Font symbols - Use JetBrainsMono Nerd Font for all icon/powerline ranges
# This gives us working ligatures from regular font + icons from Nerd Font
symbol_map U+E0A0-U+E0A3,U+E0B0-U+E0B3 JetBrainsMono Nerd Font
symbol_map U+E0A3,U+E0B4-U+E0C8,U+E0CA,U+E0CC-U+E0D7 JetBrainsMono Nerd Font
symbol_map U+E200-U+E2A9 JetBrainsMono Nerd Font
symbol_map U+E300-U+E3E3 JetBrainsMono Nerd Font
symbol_map U+E5FA-U+E6B5 JetBrainsMono Nerd Font
symbol_map U+E700-U+E7C5 JetBrainsMono Nerd Font
symbol_map U+EA60-U+EBEB JetBrainsMono Nerd Font
symbol_map U+F000-U+F2E0 JetBrainsMono Nerd Font
symbol_map U+F300-U+F32F JetBrainsMono Nerd Font
symbol_map U+F400-U+F532 JetBrainsMono Nerd Font
symbol_map U+23FB-U+23FE,U+2B58 JetBrainsMono Nerd Font
symbol_map U+F0001-U+F1AF0 JetBrainsMono Nerd Font
symbol_map U+2665,U+26A1 JetBrainsMono Nerd Font

# ────────────────────────────────────────────────────────────────────────────────────────────────────────────
# 🎨 COLOR SCHEME - Dynamic TokyoNight theme (will be included from theme.conf)
# ────────────────────────────────────────────────────────────────────────────────────────────────────────────

# Include dynamic theme configuration
include ~/.config/kitty/theme.conf

# ────────────────────────────────────────────────────────────────────────────────────────────────────────────
# 🖼️ WINDOW CONFIGURATION
# ────────────────────────────────────────────────────────────────────────────────────────────────────────────

# Initial window size
remember_window_size  yes
initial_window_width  120c
initial_window_height 40c

# Window padding (matching WezTerm)
window_padding_width 8

# Window decorations
hide_window_decorations no
macos_titlebar_color system
macos_option_as_alt yes
macos_quit_when_last_window_closed no
macos_window_resizable yes

# Transparency
background_opacity 1.0
background_blur 0

# ────────────────────────────────────────────────────────────────────────────────────────────────────────────
# 📜 SCROLLING & HISTORY
# ────────────────────────────────────────────────────────────────────────────────────────────────────────────

scrollback_lines 10000
scrollback_pager less --chop-long-lines --RAW-CONTROL-CHARS +INPUT_LINE_NUMBER
scrollback_pager_history_size 10

# Scroll to bottom when typing
scroll_on_input yes

# Keep scrollback in pager
scrollback_in_new_tab yes

# ────────────────────────────────────────────────────────────────────────────────────────────────────────────
# 🖱️ MOUSE CONFIGURATION
# ────────────────────────────────────────────────────────────────────────────────────────────────────────────

# Mouse behavior
mouse_hide_wait 3.0
copy_on_select no
strip_trailing_spaces smart
select_by_word_characters @-./_~?&=%+#

# Mouse actions
mouse_map middle release ungrabbed paste_from_selection
mouse_map cmd+left click ungrabbed mouse_handle_click selection link prompt

# URL handling
url_style curly
open_url_with default
detect_urls yes
url_prefixes file ftp ftps gemini git gopher http https irc ircs kitty mailto news sftp ssh

# ────────────────────────────────────────────────────────────────────────────────────────────────────────────
# 🔲 CURSOR CONFIGURATION - Smooth & fancy!
# ────────────────────────────────────────────────────────────────────────────────────────────────────────────

# Cursor shape and style
cursor_shape block
cursor_beam_thickness 1.5
cursor_underline_thickness 2.0

# Smooth cursor blinking for that premium feel
cursor_blink_interval 0.5
cursor_stop_blinking_after 15.0

# Text cursor color - will be set by theme but can override here
# cursor #7aa2f7
# cursor_text_color #1a1b26

# Unfocused cursor opacity for subtle effect
cursor_unfocused_hollow true

# Disable custom beam cursor on macOS for consistency
macos_custom_beam_cursor no

# ────────────────────────────────────────────────────────────────────────────────────────────────────────────
# 🎵 BELL CONFIGURATION
# ────────────────────────────────────────────────────────────────────────────────────────────────────────────

enable_audio_bell no
visual_bell_duration 0.0
window_alert_on_bell no
bell_on_tab no

# ────────────────────────────────────────────────────────────────────────────────────────────────────────────
# ⚙️ PERFORMANCE & RENDERING
# ────────────────────────────────────────────────────────────────────────────────────────────────────────────

# Rendering optimizations
repaint_delay 10
input_delay 3
sync_to_monitor yes

# GPU rendering for better performance
macos_traditional_fullscreen no

# ────────────────────────────────────────────────────────────────────────────────────────────────────────────
# 📑 TAB BAR CONFIGURATION
# ────────────────────────────────────────────────────────────────────────────────────────────────────────────

tab_bar_edge top
tab_bar_style powerline
tab_powerline_style slanted
tab_bar_min_tabs 2
tab_title_template "{fmt.fg.red}{bell_symbol}{activity_symbol}{fmt.fg.tab}{index}: {title}"
active_tab_title_template "{fmt.fg.red}{bell_symbol}{activity_symbol}{fmt.fg.tab}{index}: {title}"

# Tab bar colors (will be overridden by theme)
active_tab_font_style   bold
inactive_tab_font_style normal

# ────────────────────────────────────────────────────────────────────────────────────────────────────────────
# 🌍 ENVIRONMENT VARIABLES
# ────────────────────────────────────────────────────────────────────────────────────────────────────────────

env TERM_PROGRAM=kitty
env TERM=xterm-kitty
env COLORTERM=truecolor
env LANG=en_US.UTF-8
env LC_ALL=en_US.UTF-8
env LC_CTYPE=en_US.UTF-8

# ────────────────────────────────────────────────────────────────────────────────────────────────────────────
# ⌨️ KEY BINDINGS - Matching WezTerm + Kitty extras
# ────────────────────────────────────────────────────────────────────────────────────────────────────────────

# Clear all default shortcuts first
clear_all_shortcuts yes

# Core macOS shortcuts
map cmd+n new_os_window
map cmd+q quit
map cmd+enter toggle_fullscreen

# Clipboard
map cmd+c copy_to_clipboard
map cmd+v paste_from_clipboard
map cmd+a select_all

# Window management
map cmd+h hide_macos_app
map cmd+m minimize_macos_window

# Font size control
map cmd+plus  change_font_size all +1.0
map cmd+equal change_font_size all +1.0
map cmd+minus change_font_size all -1.0
map cmd+0     change_font_size all 0

# Search
map cmd+f launch --type=overlay --stdin-source=@screen_scrollback /usr/bin/less --chop-long-lines --RAW-CONTROL-CHARS +INPUT_LINE_NUMBER

# Tab management
map cmd+t new_tab
map cmd+w close_tab
map cmd+[ previous_tab
map cmd+] next_tab

# Quick tab switching
map cmd+1 goto_tab 1
map cmd+2 goto_tab 2
map cmd+3 goto_tab 3
map cmd+4 goto_tab 4
map cmd+5 goto_tab 5
map cmd+6 goto_tab 6
map cmd+7 goto_tab 7
map cmd+8 goto_tab 8
map cmd+9 goto_tab -1

# Window/Pane management (Kitty windows)
map cmd+d launch --location=vsplit --cwd=current
map cmd+shift+d launch --location=hsplit --cwd=current
map cmd+x close_window

# Window navigation (vim-style)
map cmd+alt+h neighboring_window left
map cmd+alt+l neighboring_window right
map cmd+alt+k neighboring_window up
map cmd+alt+j neighboring_window down

# Window resizing
map cmd+shift+h resize_window narrower 5
map cmd+shift+l resize_window wider 5
map cmd+shift+k resize_window shorter 5
map cmd+shift+j resize_window taller 5

# Clear terminal
map cmd+k clear_terminal scrollback active

# Layout management
map cmd+l next_layout

# Scrolling
map cmd+shift+g show_last_command_output
map cmd+shift+u scroll_page_up
map cmd+shift+d scroll_page_down
map cmd+home scroll_home
map cmd+end scroll_end

# Hints (similar to tmux copy mode)
map cmd+shift+e open_url_with_hints
map cmd+shift+p>f kitten hints --type path --program -
map cmd+shift+p>h kitten hints --type hash --program -
map cmd+shift+p>l kitten hints --type line --program -
map cmd+shift+p>w kitten hints --type word --program -

# ────────────────────────────────────────────────────────────────────────────────────────────────────────────
# 🔧 MISC SETTINGS
# ────────────────────────────────────────────────────────────────────────────────────────────────────────────

# Shell integration
shell_integration enabled
allow_remote_control yes
listen_on unix:/tmp/kitty

# Clipboard
clipboard_control write-clipboard write-primary read-clipboard read-primary

# Terminal features
term xterm-kitty
update_check_interval 0

# MacOS specific
macos_option_as_alt yes
macos_hide_from_tasks no
macos_custom_beam_cursor no

# Selection
rectangle_select_modifiers ctrl+alt

# Layouts
enabled_layouts splits,stack,tall,fat,grid,horizontal,vertical

# Close confirmation
confirm_os_window_close 0

# ────────────────────────────────────────────────────────────────────────────────────────────────────────────
# 🎯 URL HANDLING
# ────────────────────────────────────────────────────────────────────────────────────────────────────────────

url_color #0087bd
url_style curly

# ────────────────────────────────────────────────────────────────────────────────────────────────────────────
# 📋 SELECTION COLORS
# ────────────────────────────────────────────────────────────────────────────────────────────────────────────

# Selection colors will be set by theme
mark1_foreground black
mark1_background #98d3cb
mark2_foreground black
mark2_background #f2dcd3
mark3_foreground black
mark3_background #f274bc