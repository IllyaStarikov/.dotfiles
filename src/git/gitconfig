# Git Configuration - Essential Settings with Performance Optimizations

[user]
    name = Illya Starikov
    email = illya@starikov.co
    # SSH key for commit signing (update path if using GPG instead)
    signingkey = ~/.ssh/id_rsa.pub

[core]
    editor = nvim
    pager = delta
	excludesfile = ~/.gitignore
    # Performance: cache untracked files info, speeds up git status by 10-50%
    untrackedCache = true  # Default: false

[init]
    defaultBranch = main

[pull]
    # Rebase local commits on top of upstream when pulling
    rebase = true  # Default: false (creates cleaner linear history)

[push]
    # Automatically set upstream tracking for new branches
    autoSetupRemote = true  # Default: false (eliminates need for --set-upstream)

[merge]
    # Enhanced conflict markers showing common ancestor
    conflictstyle = zdiff3  # Default: merge (shows before/after/ancestor)
    # Handle more file renames in merge operations
    renameLimit = 10000     # Default: 1000 (prevents "too many files" errors)

[diff]
    # Better diff algorithm for code changes
    algorithm = histogram   # Default: myers (produces more readable diffs)
    # Handle more file renames in diff operations
    renameLimit = 10000     # Default: 400 (prevents rename detection failures)

[commit]
    template = ~/.gitmessage
    gpgsign = true

# Essential Aliases (most commonly used)
[alias]
    # Status/Info
    s = status -sb
    l = log --oneline --graph --decorate -20

    # Basic operations
    a = add
    c = commit
    p = push
    pl = pull
    co = checkout
    b = branch

    # Useful shortcuts
    aa = add --all
    cm = commit -m
    undo = reset --soft HEAD~1
    amend = commit --amend --no-edit

    # Workflow
    main = checkout main
    wip = !git add -A && git commit -m 'WIP'

# Delta pager configuration for better diffs
[delta]
    # Use n/N keys to navigate between diff sections
    navigate = true       # Default: false
    # Show diffs in split view (old | new)
    side-by-side = true   # Default: false
    # Display line numbers in diffs
    line-numbers = true   # Default: false

# Performance optimizations for large repositories
[pack]
    # Use all available CPU cores for packing objects
    threads = 0          # Default: 1 (0 = auto-detect cores)
    # Limit memory per packing thread
    windowMemory = 256m  # Default: unlimited (prevents OOM on large repos)
    # Split packs at 2GB for GitHub compatibility
    packSizeLimit = 2g   # Default: unlimited (GitHub's maximum)

# GitHub CLI credential helper
[credential "https://github.com"]
    helper =
    helper = !/opt/homebrew/bin/gh auth git-credential

# Use SSH keys for commit signing (simpler than GPG)
[gpg]
    format = ssh

# Security: verify object integrity during transfers
[transfer]
    fsckobjects = true  # Default: false (detects corruption early)

[receive]
    fsckobjects = true  # Default: false (verify on receive)

[fetch]
    fsckobjects = true  # Default: false (verify on fetch)

# Garbage collection tuning for better performance
[gc]
    # Run gc after 256 loose objects instead of 6700
    auto = 256  # Default: 6700 (more frequent gc = smaller operations)

# Git LFS (Large File Storage) configuration
[filter "lfs"]
	clean = git-lfs clean -- %f
	smudge = git-lfs smudge -- %f
	process = git-lfs filter-process
	required = true